/root/anaconda3/envs/relic/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1416: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
/root/anaconda3/envs/relic/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1416: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
/root/anaconda3/envs/relic/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1416: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
/root/anaconda3/envs/relic/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1416: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
/root/anaconda3/envs/relic/lib/python3.9/site-packages/sklearn/cluster/_kmeans.py:1416: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
(100, 5)
X(time slices): [0.    0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01  0.011
 0.012 0.013 0.014 0.015 0.016 0.017 0.018 0.019 0.02  0.021 0.022 0.023
 0.024 0.025 0.026 0.027 0.028 0.029 0.03  0.031 0.032 0.033 0.034 0.035
 0.036 0.037 0.038 0.039 0.04  0.041 0.042 0.043 0.044 0.045 0.046 0.047
 0.048 0.049 0.05  0.051 0.052 0.053 0.054 0.055 0.056 0.057 0.058 0.059
 0.06  0.061 0.062 0.063 0.064 0.065 0.066 0.067 0.068 0.069 0.07  0.071
 0.072 0.073 0.074 0.075 0.076 0.077 0.078 0.079 0.08  0.081 0.082 0.083
 0.084 0.085 0.086 0.087 0.088 0.089 0.09  0.091 0.092 0.093 0.094 0.095
 0.096 0.097 0.098 0.099]
X(shape): (100,)
Y(time series): [[-9.2957e-01 -1.9871e+00 -2.6010e+00 -1.9344e+00 -8.9692e-01]
 [-4.6800e-01 -2.2729e-01 -1.7013e+00 -5.2046e-01 -1.4791e+00]
 [-7.0584e-01  2.7298e+00  3.3141e-01 -1.2066e+00 -2.1882e+00]
 [ 1.2871e+00  1.9807e+00  1.7316e+00  9.9188e-01  1.0856e+00]
 [ 3.0389e+00  1.9811e+00 -3.1255e-01 -1.2442e-01  9.4411e-01]
 [-1.2298e+00 -3.3262e+00 -1.9646e+00 -5.0385e-01  3.4984e+00]
 [-4.2744e+00 -2.5750e+00  3.8341e-01 -5.9809e-02  1.6535e+00]
 [ 1.8245e+00  1.4549e+00  1.2913e+00  4.8489e+00  1.4363e+00]
 [ 5.2950e+00  1.2269e-01  8.2043e-01  2.5263e+00  2.4205e-01]
 [ 8.9603e-01 -1.0173e+00 -7.4114e-01  2.7463e+00  9.2097e-01]
 [-5.1656e+00 -4.6945e-02  3.3121e+00  4.0886e+00 -4.7719e-01]
 [-3.9094e-01  5.9014e-01  5.7497e+00  1.4716e+00  1.9214e+00]
 [ 4.1056e+00  1.6711e+00  4.0270e+00  2.7686e-01  1.0500e-01]
 [ 4.4209e+00  8.9951e-01  2.2757e+00 -1.5095e+00 -2.1402e-01]
 [-3.2723e-02  1.7014e+00  1.8884e+00 -3.4687e+00  1.2095e+00]
 [-3.1097e+00  1.9745e+00  1.3000e+00 -2.3476e+00  2.4894e+00]
 [ 3.0220e+00  1.6388e+00 -3.3101e+00 -2.6766e+00 -3.3739e+00]
 [-2.5195e-01 -2.3818e-02 -2.5885e+00 -2.4610e+00 -9.6096e-01]
 [-1.5460e+00  8.9060e-01 -1.8969e+00 -3.1320e+00  5.5144e-01]
 [-4.4526e+00  7.7870e-01 -2.9559e+00  2.1430e+00 -6.7072e-01]
 [-7.2656e-03 -5.9639e+00 -4.6011e+00 -2.1492e+00 -7.2799e+00]
 [ 4.2078e-01 -2.4714e+00 -1.2497e+00 -4.4585e+00 -6.1971e-01]
 [-5.7299e-01 -4.3276e+00 -3.2013e+00 -1.2265e+00 -1.5576e-01]
 [-4.9548e+00 -2.6833e+00 -2.8907e+00 -8.1722e-02  2.3464e+00]
 [-2.0947e+00 -1.8560e+00 -1.0243e+00  9.7398e-01 -1.9019e+00]
 [ 3.7635e+00 -7.0842e-02  3.7853e-01  2.8928e-01 -3.9406e+00]
 [-1.1924e+00 -6.5127e-01  6.6535e-01  4.7584e-01 -2.4628e-01]
 [-1.4887e+00 -1.5691e+00  4.7747e+00  2.1137e+00 -4.3541e-01]
 [ 3.3544e+00  9.0636e-01  3.2759e+00  1.3594e+00  5.8903e+00]
 [ 4.1372e+00  2.3217e+00 -1.2763e+00  1.1392e+00 -2.5525e-01]
 [ 2.5111e+00  2.6706e+00  2.8842e+00  1.0970e+00 -6.4833e-01]
 [ 2.2177e+00  4.2239e+00  2.4593e+00  4.3386e-01 -2.3932e+00]
 [-2.1256e+00  3.6946e+00 -1.7683e+00  4.6592e+00  2.5078e+00]
 [-4.0620e+00  2.5332e+00  9.4442e-02  1.4456e+00  7.6959e-01]
 [-3.8253e+00  2.2381e+00 -2.0100e-01  1.9447e+00 -1.1555e+00]
 [-3.4868e+00 -1.7210e-01  1.9527e+00 -8.4679e-03  9.7027e-02]
 [-1.2861e+00 -3.1469e+00  2.7535e+00  2.5923e+00  2.0972e+00]
 [-7.7344e-01 -1.6696e+00 -1.4433e+00  2.7059e+00  1.7137e+00]
 [ 1.1760e-01 -2.4925e+00 -2.7366e+00 -5.8062e-01 -2.2793e+00]
 [ 1.5406e-02 -5.6297e-01 -3.9174e+00 -2.9145e+00 -2.7861e+00]
 [-7.4559e-01  1.6792e-02  6.0609e-01 -3.7204e+00 -1.5003e+00]
 [ 2.9309e+00 -5.3482e-02  3.0004e+00 -1.0951e+00  3.8255e+00]
 [ 9.4674e-01 -2.0603e+00 -3.3549e+00 -3.2427e+00  1.1972e+00]
 [-2.9047e-01 -7.4736e-01 -3.4735e+00 -5.3591e+00 -3.8342e+00]
 [ 1.7041e+00  3.7911e-03 -9.6393e-01 -2.8879e-01 -2.3536e+00]
 [ 3.8912e-01  4.6140e+00  2.5032e-01 -6.2414e-01  6.3215e-01]
 [ 1.5278e+00  2.9305e+00  1.0719e-01  1.4313e+00  2.5083e+00]
 [ 1.7916e+00  1.3264e+00 -3.7060e-02  3.4888e+00  3.6435e+00]
 [ 4.4864e+00  3.3493e+00  1.4127e+00  1.4620e+00  5.4157e+00]
 [ 4.5779e+00 -6.6545e-01 -4.5533e-01 -2.9034e-01  4.9817e-01]
 [ 9.6464e-01 -3.8883e+00  2.6380e+00 -6.0616e-01 -2.2663e+00]
 [ 2.1822e+00  3.1175e-01  2.5358e+00 -1.1768e+00  7.4355e-01]
 [-2.0068e-01 -2.6306e+00 -3.7198e+00 -1.1999e+00 -2.1127e-01]
 [-2.7961e+00 -3.0531e+00 -1.8396e+00 -1.6038e+00 -9.0866e-01]
 [ 1.1566e-01 -8.0121e-01  4.1946e+00  4.5687e+00  1.0399e+00]
 [-2.7937e-01  3.8301e-01  4.0227e+00 -1.3023e-01  7.1976e-01]
 [-7.9654e-01 -1.1632e+00 -2.9009e+00 -2.7603e+00 -1.5901e+00]
 [-2.2242e+00 -1.5688e+00 -3.9105e+00 -1.1390e+00 -2.1135e+00]
 [-1.3772e+00  2.9649e-02 -1.2995e+00 -2.5744e+00  7.8809e-01]
 [-9.8109e-01 -1.1282e+00  2.5895e+00  3.2654e-01  1.9137e+00]
 [ 2.2749e+00  3.5863e-01  2.4457e+00  3.1876e+00  2.3332e+00]
 [ 8.6407e-02  1.4271e+00 -6.8716e-01  2.2980e+00  3.2137e+00]
 [-2.0297e+00 -1.1839e-01 -2.0834e+00 -1.6638e+00 -2.3136e+00]
 [-6.4114e-01  7.6874e-01 -8.0280e-01  5.1123e-01 -3.0592e+00]
 [ 1.1109e+00  2.9745e+00  1.3135e+00 -8.8977e-03 -1.3339e+00]
 [ 2.0195e+00  3.6735e+00  1.0412e+00  2.2187e-01 -2.5230e-01]
 [ 2.7621e+00  6.4726e+00  1.6019e+00  1.4814e+00  1.1584e+00]
 [ 1.7734e-01  3.9325e+00  1.3950e+00  2.5326e+00  6.2955e-01]
 [-5.4217e+00  9.3555e-01  2.8264e+00 -2.9415e-01  7.9515e-01]
 [-1.3350e+00  1.2891e+00 -2.4051e-01  6.3131e-01  2.1796e-01]
 [-5.0549e-02 -3.5967e+00 -8.6996e-01 -1.6555e-01  1.9244e+00]
 [ 3.1781e-01 -2.8013e+00  2.1466e+00  2.5013e+00  3.5059e+00]
 [-8.2231e-01 -2.5220e+00  5.1642e+00  5.0211e+00  4.0300e+00]
 [ 1.0580e-01 -3.0875e+00 -1.8959e+00  1.2313e+00 -2.1417e+00]
 [ 1.0746e+00 -7.7017e-02 -1.0714e+00 -1.0615e+00 -5.8004e+00]
 [ 2.2039e+00  9.9955e-01  4.2760e+00 -1.0910e+00  1.0968e+00]
 [ 2.8197e+00  5.5252e-02  4.2402e+00  7.6713e-01  7.9854e-01]
 [ 1.0900e+00 -8.6267e-01  3.8775e+00  1.4643e+00  4.5988e+00]
 [-2.7989e+00  6.2608e-01  9.4838e-01  2.1881e+00  7.7295e-01]
 [-4.1532e+00  9.7675e-01 -4.9180e+00 -1.5635e+00 -1.0349e+00]
 [ 3.5023e+00 -1.7523e+00 -4.1284e+00 -3.7852e+00  7.9323e-01]
 [ 1.1922e+00  9.8538e-01 -3.4189e+00 -3.4374e+00 -9.7209e-01]
 [-1.5636e+00 -3.4612e-01 -1.0691e+00 -9.6857e-01 -3.8874e+00]
 [-1.9368e+00 -3.3550e+00 -3.9382e-01  8.1226e-01 -2.8511e+00]
 [-1.3516e+00 -2.6278e+00 -9.0890e-01  1.2844e+00 -1.9833e-01]
 [ 2.0280e+00 -8.9299e-01 -3.6775e+00  3.5243e+00 -3.1433e-01]
 [ 3.8741e+00  5.4328e-01 -1.3949e+00  2.4325e-01 -1.0871e-01]
 [-5.2769e-01 -1.4525e+00  1.9370e+00 -1.7067e+00 -4.6840e+00]
 [-3.8786e+00  1.9906e+00  4.3090e+00 -1.5292e+00 -1.1036e+00]
 [-1.6299e+00  1.7176e+00  1.7439e+00 -1.0003e+00 -1.2259e+00]
 [-1.6403e+00 -1.5307e+00 -3.1630e+00 -3.8641e-01 -3.0318e+00]
 [ 1.4756e+00 -2.4897e+00 -3.3425e+00 -1.7062e+00 -9.2717e-02]
 [ 3.3057e+00  3.1007e+00 -1.0710e+00 -1.5422e+00  1.0554e-01]
 [ 1.9819e+00  3.4962e+00 -2.0661e+00 -2.6033e+00  9.6597e-01]
 [-2.4791e+00 -2.4814e+00 -1.6773e+00 -1.5107e+00 -1.6163e+00]
 [-3.9807e+00 -7.3974e-01 -1.7776e+00 -1.0005e+00 -9.7654e-02]
 [-2.5291e+00  2.0465e+00  3.6561e-01 -7.8870e-02  1.2016e+00]
 [ 1.4190e+00 -7.5404e-01  4.1360e+00  3.4161e+00  4.6226e-01]
 [ 1.1602e+00 -1.0304e+00  2.6041e+00  1.8385e+00  2.6972e+00]
 [-1.1381e+00 -1.2185e+00 -5.0840e+00 -2.4772e+00 -4.5037e-01]]
Y(shape): (100, 5)
(90, 10, 1) (90, 10, 5) (90, 1, 1) (90, 1, 5)
total samples 90
training samples: 54 validation samples: 18 testing samples: 18
seed 10 test MSE 6.993097305297852 test r2 -0.6684443641992106
seed 11 test MSE 5.843659400939941 test r2 -0.3492024893787558
seed 12 test MSE 4.849940299987793 test r2 -0.1002811874436063
seed 13 test MSE 5.086681365966797 test r2 -0.18580716004481465
seed 14 test MSE 5.433349609375 test r2 -0.23379760930104876
seed 15 test MSE 5.171545505523682 test r2 -0.20514663972994324
seed 16 test MSE 5.375931262969971 test r2 -0.24363466688049967
seed 17 test MSE 5.299283981323242 test r2 -0.18021661223116386
seed 18 test MSE 4.810947895050049 test r2 -0.08964916264007092
seed 19 test MSE 4.84926176071167 test r2 -0.10387453464859522
(10, 5, 5)
(10, 5, 5)
[[0.21147734 0.18372057 0.22177048 0.19290614 0.19012547]
 [0.20700506 0.20518476 0.22490871 0.17457076 0.18833071]
 [0.18077409 0.17919433 0.22856122 0.21757007 0.1939003 ]
 [0.2078973  0.19475931 0.21632402 0.19285425 0.18816512]
 [0.21219338 0.18430787 0.21778329 0.18364907 0.2020664 ]]
[(0, 0, 1), (2, 0, 1), (0, 1, 1), (1, 1, 1), (2, 1, 1), (2, 2, 1), (3, 2, 1), (0, 3, 1), (2, 3, 1), (0, 4, 1), (2, 4, 1), (4, 4, 1)]
===================Results===================
0 causes 0 with a delay of 1 time steps.
2 causes 0 with a delay of 1 time steps.
0 causes 1 with a delay of 1 time steps.
1 causes 1 with a delay of 1 time steps.
2 causes 1 with a delay of 1 time steps.
2 causes 2 with a delay of 1 time steps.
3 causes 2 with a delay of 1 time steps.
0 causes 3 with a delay of 1 time steps.
2 causes 3 with a delay of 1 time steps.
0 causes 4 with a delay of 1 time steps.
2 causes 4 with a delay of 1 time steps.
4 causes 4 with a delay of 1 time steps.
===================Evaluation===================
Total False Positives': 5
Total True Positives': 7
Total False Negatives: 4
Total Direct False Positives: 6
Total Direct True Positives: 6
TPs': ['0->0', '2->0', '1->1', '2->1', '2->2', '3->2', '4->4']
FPs': ['0->1', '0->3', '2->3', '0->4', '2->4']
TPs direct: ['0->0', '1->1', '2->1', '2->2', '3->2', '4->4']
FPs direct: ['2->0', '0->1', '0->3', '2->3', '0->4', '2->4']
FNs: ['1->0', '4->0', '3->3', '4->3']
(includes direct and indirect causal relationships)
Precision': 0.5833333333333334
Recall': 0.6363636363636364
F1' score: 0.6086956521739131
(includes only direct causal relationships)
Precision: 0.5
Recall: 0.6
F1 score: 0.5454545454545454
Percentage of delays that are correctly discovered: 100.0%
